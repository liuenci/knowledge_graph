三次握手的简要描述

1. 客户端对服务器端说：我要和你建立连接。
1. 服务器端对客户端说：你真的要和我建立连接吗？
1. 客户端对服务器端说：我真的要和你建立连接。
1. py 交易达成，进行数据传输。
三次握手的详细描述
1. 第一次握手：客户端将标志位 SYN 置为 1，并随机生成一个 seq = J，并且将该数据包发送给服务器端。此时客户端进入 SYN_SENT 状态，等待服务器端确认。
1. 第二次握手：服务器端接收到数据包之后由 SYN=1 知道客户端在请求建立连接。此时服务器端将 SYN 以及 ACK 都置为1，ack = J+1，并且随机产生一个 seq = K，并且将这个数据包发送给客户端以确认连接请求，此时服务器端进入 SYN_RCVD 状态。
1. 第三次握手：客户端收到数据包之后，检查 SYN=1，ACK=1，ack=J+1，seq=K，如果正确就将 ACK=1，ack=K+1，并且将这个数据包发送给服务器端，服务器端检查 ACK=1，ack=K+1，如果正确，此时客户端以及服务器端都进入 ESTABLISHED 状态，完成三次握手。之后两者就能相互传输数据了。



![image.png](https://cdn.nlark.com/yuque/0/2021/png/493161/1638717765625-3fe65598-7886-4a86-aab8-319ba82d379f.png#clientId=u08829677-0a67-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=423&id=u23f63f5c&margin=%5Bobject%20Object%5D&name=image.png&originHeight=423&originWidth=595&originalType=binary&ratio=1&rotation=0&showTitle=false&size=84924&status=done&style=none&taskId=u98dbe054-d4f7-4299-8c2e-0f6d8ab4198&title=&width=595)


#### 三次握手的原因
第三次握手是为了防止失效的连接请求到达服务器，让服务器错误打开连接。
​

客户端发送的连接请求如果在网络中滞留，那么就会隔很长一段时间才能收到服务器端发回的连接确认。客户端等待一个超时重传时间之后，就会重新请求连接。但是这个滞留的连接请求最后还是会到达服务器，如果不进行三次握手，那么服务器就会打开两次握手。如果有第三次握手，客户端就会忽略服务器之后发送的对滞留连接请求的连接确认，不进行第三次握手，因此就不会打开连接。
